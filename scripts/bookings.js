import firebaseAuth from "../components/firebaseAuth.js";
import { authenticationObject } from "../components/firebaseAuth.js";
// var bookings = [
//     {
//         name: "NEIL ISLAND",
//         info: "Neil Island is one of India’s Andaman Islands, in the Bay of Bengal. Bharatpur Beach has coral reefs teeming with tropical fish. Laxmanpur Beach is known for its sunset views. Howrah Bridge is a natural rock formation accessible at low tide. Near the island’s wharf is Neil Kendra village, with a curving, sandy bay dotted with boats. Off the southeast coast, the tiny Sir Hugh Rose Island is a sanctuary for turtles.",
//         images: "https://www.tripsavvy.com/thmb/SF7NoKaUPvXKxBkDbmPrC-GSddU=/2121x1414/filters:fill(auto,1)/GettyImages-508601155-592e840f5f9b5859500d0724.jpg",
//         "location": "https://www.google.co.in/maps/place/Samudrika+Marine+Museum/@11.6718057,92.7263692,15z/data=!4m2!3m1!1s0x0:0xd7352994a1c32fb8?sa=X&ved=2ahUKEwi64_yEu_PlAhWMILcAHYtnBf0Q_BIwC3oECBAQCA",
//         location: "https://www.google.co.in/maps/place/Neill+Island,+Andaman+and+Nicobar+Islands+744104/data=!4m2!3m1!1s0x3088d9a13824c715:0xddd01ec98b4eb529?sa=X&ved=2ahUKEwjTjPqquvPlAhU56nMBHbmRBCAQ8gEwJXoECBAQBA",
//         id: 1,
//         price: "785.6",
//         ratings: "3.3",
//         recommended: false,
//         trending: false,
//         sdate: "2-Aug",
//         edate: "5-Aug",
//         guest: "4",
//     },
//     {
//         name: "PORT BLAIR",
//         info: "It has been an important historical part of Port Blair. Notable freedom fighters such as Veer Savarkar, Yogendra Shukla, Batukeshwar Dutt, and Babarao Savarkar were some of the inmates here. Don’t miss the light and sound show(Monday, Wednesday and Friday) when you visit Cellular jail. ",
//         images: "https://www.holidify.com/images/cmsuploads/compressed/3616_20190213160612jpg",
//         location: "https://www.google.co.in/maps/place/Cellular+Jail+National+Monument/@11.6738247,92.7479768,15z/data=!4m2!3m1!1s0x0:0x616a8c6623fdba3f?sa=X&ved=2ahUKEwihqtPEuvPlAhU4IbcAHThdBsAQ_BIwJnoECA4QCA",
//         id: 2,
//         price: "676.9",
//         ratings: "1.6",
//         recommended: true,
//         trending: true,
//         sdate: "2-Aug",
//         edate: "5-Aug",
//         guest: "4",
//     },
//     {
//         name: "PORT BLAIR",
//         info: "It has been an important historical part of Port Blair. Notable freedom fighters such as Veer Savarkar, Yogendra Shukla, Batukeshwar Dutt, and Babarao Savarkar were some of the inmates here. Don’t miss the light and sound show(Monday, Wednesday and Friday) when you visit Cellular jail. ",
//         images: "https://www.holidify.com/images/cmsuploads/compressed/3616_20190213160612jpg",
//         location: "https://www.google.co.in/maps/place/Cellular+Jail+National+Monument/@11.6738247,92.7479768,15z/data=!4m2!3m1!1s0x0:0x616a8c6623fdba3f?sa=X&ved=2ahUKEwihqtPEuvPlAhU4IbcAHThdBsAQ_BIwJnoECA4QCA",
//         id: 3,
//         price: "676.9",
//         ratings: "1.6",
//         recommended: true,
//         trending: true,
//         sdate: "2-Aug",
//         edate: "5-Aug",
//         guest: "4",
//     },]
// var close = [
//     {
//         name: "SAMUDRIKA NAVAL",
//         info: "This museum is a perfect blend of historical and modern Andaman. A massive blue whale, in its skeletal form, of course, greets you as you enter the museum. There is also an aquarium with fish of all shapes and sizes, from a parrotfish to the rare and venomous species of stonefish and corals.",
//         images: "https://www.tripsavvy.com/thmb/SF7NoKaUPvXKxBkDbmPrC-GSddU=/2121x1414/filters:fill(auto,1)/GettyImages-508601155-592e840f5f9b5859500d0724.jpg",
//         location: "https://www.google.co.in/maps/place/Samudrika+Marine+Museum/@11.6718057,92.7263692,15z/data=!4m2!3m1!1s0x0:0xd7352994a1c32fb8?sa=X&ved=2ahUKEwi64_yEu_PlAhWMILcAHYtnBf0Q_BIwC3oECBAQCA",
//         id:4,
//         price: "893.9",
//         ratings: "2.8",
//         recommended: false,
//         trending: false,
//         sdate: "2-Aug",
//         edate: "5-Aug",
//         guest: "4",
//     },
//     {
//         name: "HAVELOCK ISLAND",
//         info: "Havelock Island is part of Ritchie’s Archipelago, in India’s Andaman Islands. It’s known for its dive sites and beaches, like Elephant Beach, with its coral reefs. Crescent-shaped Radhanagar Beach is a popular spot for watching the sunset. On the island’s east side, rocky sections mark long, tree-lined Vijaynagar Beach.",
//         images: "https://www.tripsavvy.com/thmb/SF7NoKaUPvXKxBkDbmPrC-GSddU=/2121x1414/filters:fill(auto,1)/GettyImages-508601155-592e840f5f9b5859500d0724.jpg",
//         location: "https://www.google.co.in/maps/place/Swaraj+Dweep/@11.9656084,92.9194242,12z/data=!3m1!4b1!4m5!3m4!1s0x3088d3d85e0fe039:0x25c8aaaa513ef4bf!8m2!3d11.9760503!4d92.9875565",
//         id: 5,
//         price: "513.3",
//         ratings: "3.2",
//         recommended: false,
//         trending: false,
//         sdate: "2-Aug",
//         edate: "5-Aug",
//         guest: "4",
//     }]
//

// localStorage.setItem("bookings",JSON.stringify(bookings));
// localStorage.setItem("past",JSON.stringify(close));

// var n = Date.now();
// console.log(n);
// var BaseURL=``;
// import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
// import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signInWithPopup, GoogleAuthProvider} from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
// import { getDatabase , ref, set} from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";
// import { signOut } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";

// async function fetchUsers(email,name){
// try{
//   var response=await fetch(`${BaseUrl} /users?email=${email}`);
//   var data= await response.json();
// }
// catch(error){
// console.log(error);
// }

// }

// const firebaseConfig = {
//         apiKey: "AIzaSyBHHxqdFZiyBTugOrwa5IYiIGiWzoiFws8",
//         authDomain: "myalcazar-54aa9.firebaseapp.com",
//         projectId: "myalcazar-54aa9",
//         storageBucket: "myalcazar-54aa9.appspot.com",
//         messagingSenderId: "902327114641",
//         appId: "1:902327114641:web:6ba16ea9f45fdc432ed830"

//       };

//       const app = initializeApp(firebaseConfig);
// const auth=getAuth();
//       auth.onAuthStateChanged((user) => {
//     if (user) {
//       // User is logged in, retrieve user-specific data from Realtime Database
//       const uid = user.uid;
//       console.log(user);
//       const name = user.displayName;

//       const email = user.email;
//       fetchUsers(email,name);
//       var newname=document.getElementById("newname");
//       newname.textContent=name;
//       console.log(email);
//       console.log(name);

//       console.log(uid);
//       var logout=document.createElement("button");
//       logout.setAttribute("id","logout");
//       logout.textContent="Log Out";
//        var newdiv=document.getElementById("third");
//        newdiv.append(logout);
//        document.getElementById("logout").addEventListener("click", () => {
//       signOut(auth)
//     .then((user) => {
//       // Sign-out successful.
//       console.log(user);
//     })
//     .catch((error) => {
//       // An error happened.
//       console.log(error);
//       });
//   });

//     }

//     else {
//       // User is not logged in, redirect to login page
//       window.location.href = "mainlogin.html";
//       }

//     });
// var users =[
//     {
//       displayName: "Faisal",
//       email:"a@gmail.com",

//       bookings: [{
//         name: "NEIL ISLAND",
//         info: "Neil Island is one of India’s Andaman Islands, in the Bay of Bengal. Bharatpur Beach has coral reefs teeming with tropical fish. Laxmanpur Beach is known for its sunset views. Howrah Bridge is a natural rock formation accessible at low tide. Near the island’s wharf is Neil Kendra village, with a curving, sandy bay dotted with boats. Off the southeast coast, the tiny Sir Hugh Rose Island is a sanctuary for turtles.",
//         images: "https://www.tripsavvy.com/thmb/SF7NoKaUPvXKxBkDbmPrC-GSddU=/2121x1414/filters:fill(auto,1)/GettyImages-508601155-592e840f5f9b5859500d0724.jpg",
//         location: "https://www.google.co.in/maps/place/Samudrika+Marine+Museum/@11.6718057,92.7263692,15z/data=!4m2!3m1!1s0x0:0xd7352994a1c32fb8?sa=X&ved=2ahUKEwi64_yEu_PlAhWMILcAHYtnBf0Q_BIwC3oECBAQCA",
//         location: "https://www.google.co.in/maps/place/Neill+Island,+Andaman+and+Nicobar+Islands+744104/data=!4m2!3m1!1s0x3088d9a13824c715:0xddd01ec98b4eb529?sa=X&ved=2ahUKEwjTjPqquvPlAhU56nMBHbmRBCAQ8gEwJXoECBAQBA",
//         id:1,
//         price: "785.6",
//         ratings: "3.3",
//         recommended: false,
//         trending: false,
//         sdate: "2-Aug",
//         edate: "5-Aug",
//         guest: "4",
//         bookedTill:n
//     }]
//     },

//   ];
//   console.log(users)
const baseUrl = "http://localhost:3000";

firebaseAuth();
console.log(authenticationObject);
document.querySelector("#btnradio1").addEventListener("click", function () {
  var book = JSON.parse(localStorage.getItem("bookings")) || [];
  if (book.length == 0) {
    document.querySelector(
      "#content"
    ).innerHTML = `<h2>No Current Bookings Available<h2/>`;
  } else updateDisplay(book);
});
document.querySelector("#btnradio2").addEventListener("click", function () {
  var closed = JSON.parse(localStorage.getItem("past"));
  updateDisplay(closed);
  var ratingsElements = document.querySelectorAll(".ratings");
  ratingsElements.forEach(function (element) {
    element.style.display = "block";
  });
  var r = document.querySelectorAll(".cancel");
  r.forEach(function (element) {
    element.style.display = "none";
  });
});
var main = document.querySelector("#content");
function updateDisplay(arr) {
  main.innerHTML = "";
  arr.forEach((element, index) => {
    //console.log(element);
    var card = document.createElement("div");
    card.setAttribute("class", "cr");
    var img = document.createElement("img");
    img.setAttribute("src", element.images);
    var name = document.createElement("h3");
    name.innerText = element.name;
    var p = document.createElement("p");
    p.innerText = `From: ${element.sdate} - ${element.edate}`;
    var guest = document.createElement("p");
    guest.innerText = "Guests: " + element.guest;
    var bt_div = document.createElement("div");
    bt_div.setAttribute("class", "bt-div");
    var details = document.createElement("button");

    details.setAttribute("class", "b");
    details.setAttribute("id", "openModalBtn");
    details.setAttribute("data-bs-toggle", "offcanvas");
    details.setAttribute("data-bs-target", "#offcanvasRight");
    details.innerText = "Details";
    var cancel = document.createElement("button");
    cancel.innerText = "Cancel";
    cancel.setAttribute("class", "cancel");
    bt_div.append(details, cancel);
    var rev = document.createElement("div");
    rev.innerHTML = "Ratings :-  ";
    rev.setAttribute("class", "ratings");
    rev.setAttribute("style", "display:none;");
    review(rev);
    var price = document.createElement("h4");
    price.innerText = "Amount: Rs. " + element.price;
    cancel.addEventListener("click", function () {
      console.log("hio");
      arr.splice(index, 1);
      updateDisplay(arr);
      localStorage.setItem("bookings", JSON.stringify(arr));
      if (book.length == 0) {
        document.querySelector(
          "#content"
        ).innerHTML = `<h2>No Current Bookings Available<h2/>`;
      } else updateDisplay(book);
    });

    details.addEventListener("click", function () {
      console.log(element);

      var title = document.querySelector(".offcanvas-title");
      title.innerHTML = "";
      title.innerText = element.name;
      var info = document.querySelector(".offcanvas-body");
      info.innerHTML = "";
      info.innerText = `${element.info} \n \n Ratings:- ${element.ratings} \n Price: ${element.price} \n Guests: ---`;

      const targetButton = document.getElementById("openModalBtn");
      console.log(targetButton);
    });
    card.append(img, name, price, guest, p, bt_div, rev);
    main.append(card);
  });
}

function review(rev) {
  for (let i = 1; i <= 5; i++) {
    var st = document.createElement("span");
    st.setAttribute("class", "fa fa-star");
    st.setAttribute("id", `star-${i}`);
    rev.appendChild(st);

    st.addEventListener("click", function (event) {
      event.preventDefault();
      let num = parseInt(event.target.id.split("-")[1]);

      for (let j = 1; j <= 5; j++) {
        const star = rev.querySelector(`#star-${j}`);
        if (j <= num) {
          star.classList.add("checked");
        } else {
          star.classList.remove("checked");
        }
      }
    });
  }
  return rev;
}
var book = JSON.parse(localStorage.getItem("bookings")) || [];
if (book.length == 0) {
  document.querySelector(
    "#content"
  ).innerHTML = `<h2>No Current Bookings Available<h2/>`;
} else updateDisplay(book);

const searchBarInput = document.querySelector("#navbar .input-search>#search");
console.log(searchBarInput);
let detour = async function () {
  let allTouristDestinationApiResponse = await fetch(
    `${baseUrl}/touristDestinations`
  );
  let allTouristDestinations = await allTouristDestinationApiResponse.json();
  searchBarInput.addEventListener("input", () => {
    const searchSuggestions = document.querySelector(".search-suggestions");
    searchSuggestions.innerHTML = "";
    let inputValue = event.target.value;
    if (inputValue == "") {
      searchSuggestions.style.display = "none";
      return;
    } else {
      searchSuggestions.style.display = "block";
      let newRegExp = new RegExp(inputValue, "gi");
      let searchTouristDestinationsFilter = allTouristDestinations.filter(
        (touristDestination) => {
          return touristDestination.name.match(newRegExp);
        }
      );
      console.log(searchTouristDestinationsFilter);

      searchTouristDestinationsFilter.forEach((touristDestination) => {
        let { images, name, state } = touristDestination;
        let searchSuggestionContainer = document.createElement("div");
        searchSuggestionContainer.classList.add("search-suggestion");

        let searchSuggestionImage = document.createElement("img");
        searchSuggestionImage.src = images;

        let searchSuggestionText = document.createElement("div");

        let searchSuggestionState = document.createElement("p");
        searchSuggestionState.textContent = state;

        let searchSuggestionTitle = document.createElement("p");
        searchSuggestionTitle.textContent = name;
        searchSuggestionText.append(
          searchSuggestionTitle,
          searchSuggestionState
        );

        searchSuggestionContainer.append(
          searchSuggestionImage,
          searchSuggestionText
        );
        searchSuggestionContainer.addEventListener("click", () => {
          localStorage.setItem(
            "touristDestinationDetails",
            JSON.stringify(touristDestination)
          );
          window.location.assign("../pages/productDetails.html");
        });
        searchSuggestions.append(searchSuggestionContainer);
      });
    }
  });
};
detour();
//console.log(Date.now())

// Open the modal

// Close the modal
//   const currentDate = new Date();

//   const year = currentDate.getFullYear();
//   const month = String(currentDate.getMonth() + 1).padStart(2, '0'); // Months are zero-based
//   const day = String(currentDate.getDate()).padStart(2, '0');

//   const formattedDate = `${year}-${month}-${day}`;

//   console.log(formattedDate);

// console.log(formattedDate);
// const upcomingEvents = array.filter(element => element.date >= bookedTill);

// console.log(upcomingEvents);
